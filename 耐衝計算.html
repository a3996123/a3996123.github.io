<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>耐衝計算器</title>
    <style>
        /* 來自 index.html 的基礎樣式 */
        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; 
            margin: 0; 
            padding: 20px; 
            background: linear-gradient(135deg, #a1c4fd 0%, #c2e9fb 100%); 
            min-height: 100vh; 
            box-sizing: border-box; 
            display: flex; /* Added for centering */
            justify-content: center; /* Added for centering */
            align-items: center; /* Added for centering */
        }
        .glass-container { 
            background: rgba(255, 255, 255, 0.25); 
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1); 
            backdrop-filter: blur(10px); 
            -webkit-backdrop-filter: blur(10px); 
            border: 1px solid rgba(255, 255, 255, 0.18); 
            border-radius: 16px; 
            padding: 20px; 
        }
        .container { 
            /* 調整 max-width 以更好地容納兩個計算器 */
            max-width: 900px; 
            margin: auto; 
        }
        
        h2 { 
            border-bottom: 1px solid rgba(255, 255, 255, 0.3); 
            padding-bottom: 10px; 
            color: #333; 
            margin-top: 0; /* 確保 h2 頂部無多餘邊距 */
            margin-bottom: 30px; 
            text-align: center; /* 讓標題置中 */
        }
        
        label { 
            color: #333; 
            font-weight: 500; 
            display: block; 
            margin-bottom: 8px; 
        }

        input[type="number"], input[type="text"] { 
            width: 100%; 
            padding: 12px; 
            box-sizing: border-box; 
            background: rgba(255, 255, 255, 0.5); 
            border: 1px solid rgba(255, 255, 255, 0.3); 
            border-radius: 8px; 
            color: #333; 
            font-size: 16px; 
        }
        
        input::placeholder { color: #555; }

        input[readonly] {
            background-color: rgba(255, 255, 255, 0.3); /* 輕微變暗以區分 */
            color: #555;
        }

        button { 
            background-color: #007bff; 
            color: white; 
            border: none; 
            cursor: pointer; 
            padding: 12px; 
            font-size: 16px; 
            border-radius: 8px; 
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); 
            transition: background 0.2s ease, transform 0.2s ease, box-shadow 0.2s ease;
            width: 100%; /* 確保按鈕滿寬 */
            margin-top: 10px; /* 與上方輸入框保持間距 */
        }
        
        button:hover { 
            background-color: #0056b3; 
            transform: translateY(-3px); 
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2); 
        }

        /* 來自 耐衝計算.html 的佈局樣式 (已整合) */
        .main-wrapper {
            display: flex;
            flex-direction: row; /* 預設: 並排 */
            justify-content: center;
            align-items: flex-start; /* 頂部對齊 */
            gap: 40px; /* 計算器之間的間距 */
            width: 100%;
        }

        /* 替換原本的 .container 樣式 */
        .calculator-box {
            width: 100%;
            padding: 20px;
            /* 使用類似 searchResults 的輕微背景 */
            background: rgba(255, 255, 255, 0.2); 
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            flex: 1; /* 允許容器等寬 */
        }

        .input-group {
            margin-bottom: 15px;
            text-align: left;
        }

        /* 來自 耐衝計算.html 的響應式樣式 (已整合) */
        @media (max-width: 992px) {
            .main-wrapper {
                flex-direction: column; /* 垂直堆疊 */
                align-items: center; /* 置中 */
            }
            .calculator-box {
                width: 100%;
                max-width: 420px; /* 在行動裝置上限制寬度 */
            }
        }
    </style>
</head>
<body>

    <div class="container glass-container">
        <div class="main-wrapper">
            
            <div class="calculator-box">
                <h2>耐衝計算 I</h2>
                <div class="input-group">
                    <label for="inputField1">輸入值：</label>
                    <input type="number" id="inputField1" onkeydown="if(event.key==='Enter') calculate()" placeholder="(輸入新耐衝kg-cm的數值)">
                </div>
                <div class="input-group">
                    <label>舊耐衝(kg-cm)：</label>
                    <input type="text" id="result1_1" readonly>
                </div>
                <div class="input-group">
                    <label>新耐衝(kg-cm/cm)：</label>
                    <input type="text" id="result1_2" readonly>
                </div>
                <div class="input-group">
                    <label>新耐衝(kg-cm/cm²)：</label>
                    <input type="text" id="result1_3" readonly>
                </div>
            </div>

            <div class="calculator-box">
                <h2>耐衝計算 II</h2>
                <div class="input-group">
                    <label for="inputField2">輸入值：</label>
                    <input type="number" id="inputField2" onkeydown="if(event.key==='Enter') calculate()" placeholder="(輸入舊耐衝kg-cm的數值)">
                </div>
                 <div class="input-group">
                    <label for="output4">舊耐衝(kg-cm)：</label>
                    <input type="text" id="output4" readonly>
                </div>
                <div class="input-group">
                    <label for="output1">新耐衝(kg-cm)：</label>
                    <input type="text" id="output1" readonly>
                </div>
                <div class="input-group">
                    <label for="output2">新耐衝(kg-cm/cm)：</label>
                    <input type="text" id="output2" readonly>
                </div>
                <div class="input-group">
                    <label for="output3">新耐衝(kg-cm/cm²)：</label>
                    <input type="text" id="output3" readonly>
                </div>
                <button onclick="calculate()">計算</button>
            </div>
        </div>
    </div>

    <script>
        const lookupTable = {
            29.25: 77, 28.80: 78, 28.34: 79, 27.88: 80, 27.42: 81, 26.99: 82, 26.49: 83, 26.02: 84,
            25.56: 85, 25.09: 86, 24.62: 87, 24.16: 88, 23.69: 89, 23.22: 90, 22.75: 91, 22.29: 92,
            21.82: 93, 21.35: 94, 20.88: 95, 20.42: 96, 19.95: 97, 19.49: 98, 19.03: 99, 18.56: 100,
            18.10: 101, 17.65: 102, 17.19: 103, 16.73: 104, 16.28: 105, 15.83: 106, 15.38: 107, 14.93: 108,
            14.49: 109, 14.05: 110, 13.61: 111, 13.18: 112, 12.74: 113, 12.31: 114, 11.89: 115, 11.47: 116,
            11.05: 117, 10.63: 118, 10.22: 119, 9.81: 120, 9.41: 121, 9.01: 122, 8.62: 123, 8.24: 124,
            7.84: 125, 7.46: 126, 7.08: 127, 6.71: 128, 6.35: 129, 5.99: 130, 5.63: 131, 5.28: 132,
            4.93: 133, 4.59: 134, 4.26: 135, 3.93: 136, 3.61: 137, 3.29: 138, 2.98: 139, 2.68: 140,
            2.38: 141, 2.09: 142, 1.81: 143, 1.53: 144, 1.26: 145, 0.99: 146, 0.73: 147, 0.48: 148,
            0.24: 149, 0.00: 150
        };

        function findClosestKey(value) {
            let minDiff = Infinity;
            let closestKey = null;
            for (const key in lookupTable) {
                const diff = Math.abs(key - value);
                if (diff < minDiff) {
                    minDiff = diff;
                    closestKey = key;
                }
            }
            return closestKey;
        }

        function calculate() {
            // --- 耐衝計算 I ---
            const inputField1 = document.getElementById("inputField1");
            const inputValue1 = parseFloat(inputField1.value) || 0; // Treat empty as 0
            
            // Outputs for Calculator I
            const result1_1 = document.getElementById("result1_1");
            const result1_2 = document.getElementById("result1_2");
            const result1_3 = document.getElementById("result1_3");

            if (inputField1.value !== "") {
                const calculatedValue1 = inputValue1 + 2.2;
                const calculatedValue1_2 = inputValue1 + ((Math.random() - 0.5) * 0.6);
                const closestKey1 = findClosestKey(calculatedValue1);

                if (closestKey1 !== null) {
                    result1_1.value = lookupTable[closestKey1] + " (" + closestKey1 + ")";
                } else {
                    result1_1.value = "查無對應值";
                }
                result1_2.value = (calculatedValue1_2 / 0.317).toFixed(2);
                result1_3.value = (calculatedValue1_2 / 0.317 / 1.036).toFixed(1);
            } else {
                result1_1.value = "";
                result1_2.value = "";
                result1_3.value = "";
            }


            // --- 耐衝計算 II ---
            const inputField2 = document.getElementById("inputField2");
            const inputValue2 = parseFloat(inputField2.value); // No || 0, let it be NaN if empty

            if (inputField2.value !== "") {
                const randomOffset = Math.random() * 0.2 - 0.1;
                const output1 = inputValue2 - 2.2 + randomOffset;
                const output2 = output1 / 0.317;
                const output3 = output2 / 1.023;
                // Use .toFixed() on inputValue2 to match the key format
                const formattedInput = inputValue2.toFixed(2);
                const output4 = lookupTable.hasOwnProperty(formattedInput) ? lookupTable[formattedInput] + " (" + formattedInput + ")" : "N/A";

                document.getElementById("output1").value = output1.toFixed(2);
                document.getElementById("output2").value = output2.toFixed(2);
                document.getElementById("output3").value = output3.toFixed(1);
                document.getElementById("output4").value = output4;
            } else {
                document.getElementById("output1").value = "";
                document.getElementById("output2").value = "";
                document.getElementById("output3").value = "";
                document.getElementById("output4").value = "";
            }
        }
    </script>

</body>
</html>